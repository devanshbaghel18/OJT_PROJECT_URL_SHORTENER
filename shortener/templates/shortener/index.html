{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShortMe | URL Shortener</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

</head>
<body>

<nav class="navbar">
    <div class="nav-left">
        <a href="{% url 'home' %}" class="logo">
            <img src="{% static 'img/logo.png' %}" alt="ShortMe Logo">
            <span>ShortMe</span>
        </a>
        <a href="{% url 'home' %}" class="nav-item">Home</a>
        <a href="{% url 'features' %}" class="nav-item">Features</a>
        <a href="{% url 'history' %}" class="nav-item">History</a>
        <a href="{% url 'about' %}" class="nav-item">About</a>
    </div>

    <div class="nav-right">
        {% if user.is_authenticated %}
            <span>Hello, {{ user.username }}</span>
            <a href="{% url 'logout' %}" class="nav-btn login-btn">Logout</a>
        {% else %}
            <a href="{% url 'login' %}" class="nav-btn login-btn">Login</a>
            <a href="{% url 'signup' %}" class="nav-btn signup-btn">Signup</a>
        {% endif %}
    </div>
</nav>

<!-- Main Container -->
<div class="container">
    <header>
        <h1>Shorten Your Long URLs âœ¨</h1>
        <p>Paste your long URL below and get a short one instantly.</p>
    </header>

    <!-- Shortener Form -->
    <div class="card">
        <form method="POST">
            {% csrf_token %}
            <!-- Correct field name to match your ShortenerForm -->
            <input type="url" name="original_url" placeholder="Enter your long URL here..." required>
            <button type="submit" class="btn-shorten">Shorten URL</button>
        </form>
    </div>

    <!-- Result Section -->
    {% if short_url %}
    <div class="card result-card">
        <p><strong>Your Short URL:</strong></p>
        <div class="link-box">
            <a href="{{ short_url }}" target="_blank" id="short-link">{{ short_url }}</a>
            <button onclick="copyLink()" class="btn-copy">Copy</button>
        </div>

        {% if qr_code %}
        <div id="qr-container" class="qr-section" style="display:none;">
            <p>Scan the QR Code:</p>
            <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" />
        </div>
        <button onclick="showQR()" class="btn-qr">Show QR</button>
        {% endif %}
    </div>
    {% endif %}
</div>

<script>
function copyLink() {
    const copyText = document.getElementById("short-link").href;
    navigator.clipboard.writeText(copyText);
    alert("Link copied to clipboard!");
}

function showQR() {
    const qrBox = document.getElementById("qr-container");
    if (qrBox) qrBox.style.display = "block";
}
</script>

</body>
</html>